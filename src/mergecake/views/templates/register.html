{% extends "mergecake/views/templates/cakeday-base.html" %}
{% block cakeday-content %}
<h1>Register a cakeday</h1>
<form class="form-horizontal"
  action="{{servlet-context}}/submit-cakeday" method="POST">
  <fieldset>

    <div class="form-group">
      <label class="col-md-4 control-label" for="project">Select
        project</label>
      <div class="col-md-2">
        <select id="proj" name="proj" class="form-control"> 
          {% for proj in projects %}
            {% ifequal params.proj proj.id %}
              <option value="{{proj.id}}" selected>{{proj.projectname}}</option> 
            {% else %}
              <option value="{{proj.id}}">{{proj.projectname}}</option> 
            {% endifequal %}
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="form-group">
      <label class="col-md-4 control-label" for="user">Select
        your initials</label>
      <div class="col-md-2">
        <input type="text" class="form-control" id="user" name="user"/>
      </div>
    </div>

    <div class="form-group">
      <label class="col-md-4 control-label" for="textinput">Which day will you be bringing a treat?</label>
      <div class="col-md-2">
        <input type="text" class="form-control" id="date" name="date" value="{{params.date}}"></input>
      </div>
    </div>

    <div class="form-group">
      <label class="col-md-4 control-label" for="textarea">Comment (will be included in e-mail)</label>
      <div class="col-md-4">
        <textarea class="form-control" id="description"
          name="description">{{params.description}}</textarea>
      </div>
    </div>

    <div class="form-group">
      <div class="col-md-4 pull-right col-md-pull-1">
        <button type="submit" id="submitbutton" name="submitbutton"
          class="btn btn-primary">Submit</button>
      </div>
    </div>

  </fieldset>
</form>
{{message}}
{% script "/js/jquery-ui.js" %}
{% script "js/jquery.fuzzymatch.js" %}
<script type="text/javascript">
             
$("#user").autocomplete({
    source: function (context, callback) {
        callback($(
        	   [	
             {% for user in users %}
               "{{user.name}}",
             {% endfor %}
             ]
        ).filter(function (a) {
            // Only show items which match
            return $.fuzzyMatch(a, context.term).score;
        }).sort(function (a, b) {
            // And sort them by matchiness.
            var score_a = $.fuzzyMatch(a, context.term).score,
                score_b = $.fuzzyMatch(b, context.term).score;

            return score_a < score_b ? -1 : score_a === score_b ? 0 : 1;
        }));
    },
    delay: 0
});
</script>
{% style "/css/datepicker.css" %}
{% script "/js/bootstrap-datepicker.js" %}
<script type="text/javascript">
	$(function() {
		$('#date').datepicker({
			format : 'dd-mm-yyyy'
		});
	});
</script>
{% endblock %}
